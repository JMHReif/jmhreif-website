<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>How-To: Use Cypher DSL for programmatic queries | Jennifer Reif</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Photo credit I recently had the opportunity to play with the Cypher DSL (domain-specific language) library, and I found it difficult to figure out syntax for some of the queries I was trying to construct.
This blog post will hopefully help you understand how to construct your own programmatic queries with Cypher DSL by showing you syntax for nodes, relationships, and filtering. Then see how this in action with some examples for assembling those components into full queries translated from common clauses, functions, and result formats in Cypher."><meta name=generator content="Hugo 0.119.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link rel=canonical href=https://jmhreif.com/blog/2025/cypher-dsl-how-to/><meta property="og:title" content="How-To: Use Cypher DSL for programmatic queries"><meta property="og:description" content="Photo credit I recently had the opportunity to play with the Cypher DSL (domain-specific language) library, and I found it difficult to figure out syntax for some of the queries I was trying to construct.
This blog post will hopefully help you understand how to construct your own programmatic queries with Cypher DSL by showing you syntax for nodes, relationships, and filtering. Then see how this in action with some examples for assembling those components into full queries translated from common clauses, functions, and result formats in Cypher."><meta property="og:type" content="article"><meta property="og:url" content="https://jmhreif.com/blog/2025/cypher-dsl-how-to/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-02-06T09:00:00-06:00"><meta property="article:modified_time" content="2025-02-06T09:00:00-06:00"><meta itemprop=name content="How-To: Use Cypher DSL for programmatic queries"><meta itemprop=description content="Photo credit I recently had the opportunity to play with the Cypher DSL (domain-specific language) library, and I found it difficult to figure out syntax for some of the queries I was trying to construct.
This blog post will hopefully help you understand how to construct your own programmatic queries with Cypher DSL by showing you syntax for nodes, relationships, and filtering. Then see how this in action with some examples for assembling those components into full queries translated from common clauses, functions, and result formats in Cypher."><meta itemprop=datePublished content="2025-02-06T09:00:00-06:00"><meta itemprop=dateModified content="2025-02-06T09:00:00-06:00"><meta itemprop=wordCount content="1416"><meta itemprop=keywords content="cypher,dsl,example,how-to,query language,"><meta name=twitter:card content="summary"><meta name=twitter:title content="How-To: Use Cypher DSL for programmatic queries"><meta name=twitter:description content="Photo credit I recently had the opportunity to play with the Cypher DSL (domain-specific language) library, and I found it difficult to figure out syntax for some of the queries I was trying to construct.
This blog post will hopefully help you understand how to construct your own programmatic queries with Cypher DSL by showing you syntax for nodes, relationships, and filtering. Then see how this in action with some examples for assembling those components into full queries translated from common clauses, functions, and result formats in Cypher."></head><body class="ma0 avenir bg-near-white"><header class="cover bg-top" style=background-image:url(https://jmhreif.com/img/unsplash-cypher-dsl.jpg)><div class=bg-black-60><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Jennifer Reif</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/ title="Home page">Home</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/blog/ title="Blog page">Blog</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/abstracts/ title="Abstracts page">Abstracts</a></li></ul><div class=ananke-socials><a href=https://twitter.com/JMHReif target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/JMHReif target=_blank rel=noopener class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://www.linkedin.com/in/jmhreif/ target=_blank rel=noopener class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://jmhreif.com/index.xml target=_blank rel=noopener class="rss ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="RSS link" aria-label="follow on RSS——Opens in a new window"><span class=icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://jmhreif.podbean.com/ target=_blank rel=noopener class="podcast ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="podcast link" aria-label="follow on podcast——Opens in a new window"><span class=icon><svg width="1200pt" height="1200pt" viewBox="0 0 1200 1200" xmlns="http://www.w3.org/2000/svg"><path d="m6e2 62.484c-296.48.0-537.52 241.03-537.52 537.52s240.98 537.52 537.52 537.52c296.48.0 537.52-240.98 537.52-537.52.0-296.48-241.03-537.52-537.52-537.52zm-155.02 305.02c0-85.5 69.516-155.02 155.02-155.02S755.02 282 755.02 367.504v234.98c0 85.5-69.516 155.02-155.02 155.02s-155.02-69.516-155.02-155.02zm192.52 516.52v66c0 20.484-17.016 37.5-37.5 37.5s-37.5-17.016-37.5-37.5v-66C408 865.508 288 734.024 288 574.504c0-20.484 17.016-37.5 37.5-37.5s37.5 17.016 37.5 37.5c0 130.5 106.5 237 237 237s237-106.5 237-237c0-20.484 17.016-37.5 37.5-37.5s37.5 17.016 37.5 37.5c0 159.52-120 291-274.5 309.52z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav><div class="tc-l pv6 ph3 ph4-ns"></div></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Blog</aside><div id=sharing class="mt3 ananke-socials"><a href="https://twitter.com/intent/tweet?url=https://jmhreif.com/blog/2025/cypher-dsl-how-to/&amp;text=How-To:%20Use%20Cypher%20DSL%20for%20programmatic%20queries" class="ananke-social-link twitter no-underline" aria-label="share on Twitter"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://jmhreif.com/blog/2025/cypher-dsl-how-to/&amp;title=How-To:%20Use%20Cypher%20DSL%20for%20programmatic%20queries" class="ananke-social-link linkedin no-underline" aria-label="share on LinkedIn"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div><h1 class="f1 athelas mt3 mb1">How-To: Use Cypher DSL for programmatic queries</h1><time class="f6 mv4 dib tracked" datetime=2025-02-06T09:00:00-06:00>February 6, 2025</time>
<span class="f6 mv4 dib tracked">- 7 minutes read</span>
<span class="f6 mv4 dib tracked">- 1416 words</span></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><div class=paragraph><small><i><a href="https://unsplash.com/photos/woman-in-gray-top-on-top-of-the-building-vEACHdzvgco?utm_content=creditShareLink&amp;utm_medium=referral&amp;utm_source=unsplash">Photo credit</a></i></small></div><div class=paragraph><p>I recently had the opportunity to play with the Cypher DSL (domain-specific language) library, and I found it difficult to figure out syntax for some of the queries I was trying to construct.</p></div><div class=paragraph><p>This blog post will hopefully help you understand how to construct your own programmatic queries with Cypher DSL by showing you syntax for nodes, relationships, and filtering. Then see how this in action with some examples for assembling those components into full queries translated from common clauses, functions, and result formats in Cypher.</p></div><div class=sect1><h2 id=_what_is_cypher_dsl>What is Cypher DSL?</h2><div class=sectionbody><div class=paragraph><p>Cypher DSL generates Cypher queries using methods for filtering, pattern-matching, and more. Using a DSL could be an alternative way to assemble query syntax outside of plain text, meaning it is also type-safe (safer against injection) and offers query parsing and other functionality outside of executing queries.</p></div><div class=paragraph><p>Further detail is available in the readme of the <a href=https://github.com/neo4j/cypher-dsl target=_blank rel=noopener>Cypher DSL Github repository</a>.</p></div></div></div><div class=sect1><h2 id=_what_was_missing>What was missing?</h2><div class=sectionbody><div class=paragraph><p>When I explored the Cypher DSL for another project I was working on, I found the existing examples missing some syntax, requiring me to comb the docs, API, code, and one example repo to cobble together my syntax. (Note: the <a href=https://neo4j.github.io/cypher-dsl/2024.4.0/#functions target=_blank rel=noopener>function section of the docs</a> explicitly states that not everything is documented.) Though there are several examples in the repo, they were missing what I needed and are all in test format, which meant I also had to translate from testing syntax (<code>assertThat</code>, etc) to actually running a query against the database and retrieving results (interacting with <code>Result</code> and <code>Record</code> return objects).</p></div><div class=paragraph><p>This left me feeling bummed and spending way more time than I wanted constructing queries from multiple snippets of source material. In this post, I hope to consolidate this knowledge a bit by providing some starter examples that cover all the basic syntax for you to construct your own queries.</p></div><div class=paragraph><p>Let’s get started!</p></div></div></div><div class=sect1><h2 id=_project_setup>Project setup</h2><div class=sectionbody><div class=paragraph><p>My <a href=https://github.com/JMHReif/cypher-dsl-examples target=_blank rel=noopener>code repository for these examples</a> uses JBang scripts and includes dependencies for the Neo4j Java Driver and the Cypher DSL library.</p></div><div class=paragraph><p>The examples use a <a href=https://dev.neo4j.com/aura-java target=_blank rel=noopener>Neo4j Aura free tier instance</a> with a pre-loaded example data set (instructions for import available in the repository). Each example focuses on a different component of Cypher queries - finding individual nodes, filtering node properties, finding patterns (using relationships), and filtering patterns (with filter expressions and result-ordering).</p></div><div class=paragraph><p>Each of the example scripts sets database credentials from environment variables and creates a driver instance. Next is Cypher DSL syntax to construct the query, defining the entities up front with variables. Some of the examples define nodes and relationships within the <code>.match()</code> method, but I found it easier to read if I defined nodes and relationships to individual variables and then used those variables in the <code>Cypher.match()</code> call.</p></div><div class=paragraph><p>The next code block is the <code>try-catch</code> section that creates a driver session and calls the query. In order to run the Cypher, I needed to render the programmatic syntax into text using the <code>Renderer</code> and then execute that.</p></div><div class=paragraph><p>Lastly, the script loops through the records in the result object and prints them to the console, catches any errors, and closes the driver.</p></div></div></div><div class=sect1><h2 id=_finding_nodes_and_filtering>Finding nodes and filtering</h2><div class=sectionbody><div class=paragraph><p>The first examples focus on <a href=https://github.com/JMHReif/cypher-dsl-examples/blob/main/find_products.java target=_blank rel=noopener>finding nodes</a> and <a href=https://github.com/JMHReif/cypher-dsl-examples/blob/main/find_products_filtering.java target=_blank rel=noopener>filtering them by property value</a>.</p></div><div class=paragraph><p>To find product nodes with Cypher, you might use a query like this one:</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-cypher data-lang=cypher>MATCH (p:Product)
RETURN p.productId, p.productName;</code></pre></div></div><div class=listingblock><div class=title>Cypher DSL syntax - find product nodes:</div><div class=content><pre class=highlight><code class=language-java data-lang=java>var products = Cypher.node(&#34;Product&#34;).named(&#34;p&#34;); //(p:Product)
var query = Cypher.match(products)
	.returning(products.property(&#34;productId&#34;),
		products.property(&#34;productName&#34;))
	.build();</code></pre></div></div><div class=paragraph><p>The code above sets the variable <code>products</code> to a Cypher DSL node with label <code>Product</code> and creates a node variable <code>p</code>. This would be the equivalent to the Cypher syntax <code>(p:Product)</code>. Next, the query gets constructed by calling a <code>.match()</code> for the <code>MATCH</code> clause, passing in the product nodes, and then returning the <code>productId</code> and <code>productName</code> properties.</p></div><div class=listingblock><div class=title>Query results (only top 5 shown):</div><div class=content><pre class=highlight><code class=language-shell data-lang=shell>Found:
[p.productId: &#34;1&#34;, p.productName: &#34;Brazilian - Organic&#34;]
[p.productId: &#34;2&#34;, p.productName: &#34;Our Old Time Diner Blend&#34;]
[p.productId: &#34;3&#34;, p.productName: &#34;Espresso Roast&#34;]
[p.productId: &#34;4&#34;, p.productName: &#34;Primo Espresso Roast&#34;]
[p.productId: &#34;5&#34;, p.productName: &#34;Columbian Medium Roast&#34;]
...</code></pre></div></div><div class=paragraph><p>In the next example, you can start applying filters for node property values and return full objects rather than specific properties. Here is the sample Cypher statement:</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-cypher data-lang=cypher>MATCH (p:Product {productName: &#34;Columbian Medium Roast Sm&#34;})
RETURN p{.*};</code></pre></div></div><div class=listingblock><div class=title>Cypher DSL syntax - find filtered product nodes:</div><div class=content><pre class=highlight><code class=language-java data-lang=java>var coffee = Cypher.node(&#34;Product&#34;).named(&#34;p&#34;)
	.withProperties(&#34;productName&#34;, Cypher.literalOf(&#34;Columbian Medium Roast Sm&#34;)); //(p:Product {productName: &#34;Columbian Medium Roast Sm&#34;})
var query = Cypher.match(coffee)
	.returning(coffee.project(Cypher.asterisk()))
	.build();</code></pre></div></div><div class=paragraph><p>The first variable finds nodes with label <code>Product</code> and sets to a node variable <code>p</code>, then looks for a property (<code>.withProperties()</code>) called <code>productName</code> with a value equal to <code>"Columbian Medium Roast Sm"</code>.</p></div><div class=paragraph><p>The next variable constructs the query by calling the <code>match()</code> method for those <code>coffee</code> nodes and returns the coffee object projected with all key/value pairs.</p></div><div class=listingblock><div class=title>Query results:</div><div class=content><pre class=highlight><code class=language-shell data-lang=shell>Found:
[p: {promo: &#34;N&#34;, taxExempt: &#34;Y&#34;, unitOfMeasure: &#34;8 oz&#34;,
productId: &#34;28&#34;, retailPrice: &#34;$2.00 &#34;, wholesalePrice: &#34;0.4&#34;,
productDescription: &#34;A smooth cup of coffee any time of day. &#34;,
productName: &#34;Columbian Medium Roast Sm&#34;, newProduct: &#34;N&#34;}]</code></pre></div></div><div class=paragraph><p>Now that you can assemble Cypher for nodes with property filters and a couple different return formats, the next examples add relationships to the mix and help construct patterns!</p></div></div></div><div class=sect1><h2 id=_finding_nodes_and_filtering_2>Finding nodes and filtering</h2><div class=sectionbody><div class=paragraph><p>To start, you can pull related entities for a node with something like the Cypher below:</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-cypher data-lang=cypher>MATCH (c:Category {category: &#34;Coffee&#34;})&lt;-[rel:ORGANIZED_IN]-(t:Type)&lt;-[rel2:SORTED_BY]-(p:Product)
RETURN p.productId, p.productName;</code></pre></div></div><div class=listingblock><div class=title>Cypher DSL syntax - find products in Coffee category:</div><div class=content><pre class=highlight><code class=language-java data-lang=java>var category = Cypher.node(&#34;Category&#34;).named(&#34;c&#34;)
	.withProperties(&#34;category&#34;, Cypher.literalOf(&#34;Coffee&#34;)); //(c:Category {category: &#34;Coffee&#34;})
var types = Cypher.node(&#34;Type&#34;).named(&#34;t&#34;); //(t:Type)
var products = Cypher.node(&#34;Product&#34;).named(&#34;p&#34;); //(p:Product)
var query = Cypher.match(products
		.relationshipTo(types, &#34;SORTED_BY&#34;)
		.relationshipTo(category, &#34;ORGANIZED_IN&#34;))
	.returning(products.property(&#34;productId&#34;),
		products.property(&#34;productName&#34;))
	.build();</code></pre></div></div><div class=paragraph><p>The first variable has very similar syntax to retrieving a specific product in the node filtering example above, though this looks for a node with the <code>Category</code> label and a <code>category</code> property value of <code>Coffee</code> and sets those to the node variable <code>c</code>. Then the next two variables find related <code>Type</code> and <code>Product</code> nodes, respectively.</p></div><div class=paragraph><p>Finally, the query is constructed, and you might notice that relationships are not defined up front into separate variables, but instead within the <code>match()</code> method itself. The match looks for products with a relationship to the <code>Type</code> nodes, which have a relationship to <code>Category</code> nodes. (Note: you could use the reverse <code>relationshipFrom()</code> method to define incoming relationships.) Similar to previous examples, this query returns the <code>productId</code> and <code>productName</code> properties of <code>Product</code> nodes.</p></div><div class=listingblock><div class=title>Query results (only top 5 shown):</div><div class=content><pre class=highlight><code class=language-shell data-lang=shell>Found:
[p.productId: &#34;22&#34;, p.productName: &#34;Our Old Time Diner Blend Sm&#34;]
[p.productId: &#34;23&#34;, p.productName: &#34;Our Old Time Diner Blend Rg&#34;]
[p.productId: &#34;24&#34;, p.productName: &#34;Our Old Time Diner Blend Lg&#34;]
[p.productId: &#34;25&#34;, p.productName: &#34;Brazilian Sm&#34;]
[p.productId: &#34;26&#34;, p.productName: &#34;Brazilian Rg&#34;]
...</code></pre></div></div><div class=paragraph><p>In the next example, you can filter relationships using the Cypher <code>WHERE</code> clause and a <code>greater than</code> expression, as well as return ordered and limited results. Here is what that would look like in Cypher:</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-cypher data-lang=cypher>MATCH (p:Product {productName: &#34;Latte&#34;})&lt;-[rel:CONTAINS]-(o:Order)
WHERE rel.quantity &gt; 2
RETURN o.transactionId, p.productName, rel.quantity AS quantity
ORDER BY quantity DESC
LIMIT 10;</code></pre></div></div><div class=listingblock><div class=title>Cypher DSL syntax - find orders containing > 2 lattes:</div><div class=content><pre class=highlight><code class=language-java data-lang=java>var product = Cypher.node(&#34;Product&#34;).named(&#34;p&#34;)
	.withProperties(&#34;productName&#34;, Cypher.literalOf(&#34;Latte&#34;)); //(p:Product {productName: &#34;Latte&#34;})
var orders = Cypher.node(&#34;Order&#34;).named(&#34;o&#34;); //(o:Order)
var containsRel = product.relationshipFrom(orders, &#34;CONTAINS&#34;).named(&#34;rel&#34;); //(p)-[rel:CONTAINS]-(o)
var quantity = containsRel.property(&#34;quantity&#34;); //rel.quantity
var query = Cypher.match(containsRel)
	.where(quantity.gt(Cypher.literalOf(2)))
	.returning(orders.property(&#34;transactionId&#34;),
		product.property(&#34;productName&#34;),
		quantity)
	.orderBy(quantity.descending())
	.limit(10)
	.build();</code></pre></div></div><div class=paragraph><p>The first variable syntax follows previous examples, but looking for <code>Product</code> nodes with a <code>productName</code> equal to <code>Latte</code> and setting those to node variable <code>p</code>. The next three variables looks for <code>(o:Order)</code>, the <code>CONTAINS</code> relationship between product and orders (set to node variable <code>rel</code>), and the relationship’s <code>quantity</code> property.</p></div><div class=paragraph><p>Constructing the query matches the relationship (with connected nodes), then filters using the <code>.where()</code> method to look for order quantities greater than 2 (<code>WHERE rel.quantity > 2</code>). The query returns the order’s <code>transactionId</code>, product’s <code>productName</code>, and the relationship’s <code>quantity</code> properties, as well as orders results by quantity in descending order and limits results to the top 10.</p></div><div class=listingblock><div class=title>Query results (only top 5 shown):</div><div class=content><pre class=highlight><code class=language-shell data-lang=shell>Found:
[o.transactionId: &#34;5695cf16-4957-4082-afda-1adbe0da52f4&#34;, p.productName: &#34;Latte&#34;, rel.quantity: 3]
[o.transactionId: &#34;8f67b240-f442-4c02-9030-37023443bbcf&#34;, p.productName: &#34;Latte&#34;, rel.quantity: 3]
[o.transactionId: &#34;6fa18355-609f-47f9-b585-e617553bd2b8&#34;, p.productName: &#34;Latte&#34;, rel.quantity: 3]
[o.transactionId: &#34;8b523b23-22b2-4154-812c-e79a99202fb2&#34;, p.productName: &#34;Latte&#34;, rel.quantity: 3]
[o.transactionId: &#34;20799227-8f4a-424f-ab61-b8586d3b49eb&#34;, p.productName: &#34;Latte&#34;, rel.quantity: 3]
...</code></pre></div></div></div></div><div class=sect1><h2 id=_wrapping_up>Wrapping Up!</h2><div class=sectionbody><div class=paragraph><p>In this post, you constructed a few starting examples that cover many of the commonly-used Cypher clauses, patterns, and functions. If there are some examples you would like to see added, please create a pull request or reach out to me, and I’ll try to put those together.</p></div><div class=paragraph><p>As always, happy coding!</p></div></div></div><div class=sect1><h2 id=_resources>Resources</h2><div class=sectionbody><div class=ulist><ul><li><p>Github repository: <a href=https://github.com/JMHReif/cypher-dsl-examples target=_blank rel=noopener>Accompanying code for this blog post</a></p></li><li><p>Github repository: <a href=https://github.com/neo4j/cypher-dsl target=_blank rel=noopener>Cypher DSL library</a></p></li><li><p>Docs: <a href=https://neo4j.github.io/cypher-dsl/ target=_blank rel=noopener>Cypher DSL documentation</a></p></li><li><p>Examples: <a href=https://github.com/neo4j/cypher-dsl/tree/main/neo4j-cypher-dsl-examples target=_blank rel=noopener>Cypher DSL official examples (tests)</a></p></li></ul></div></div></div><ul class=pa0><li class="list di"><a href=/tags/cypher/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">cypher</a></li><li class="list di"><a href=/tags/dsl/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">dsl</a></li><li class="list di"><a href=/tags/example/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">example</a></li><li class="list di"><a href=/tags/how-to/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">how-to</a></li><li class="list di"><a href=/tags/query-language/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">query language</a></li></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/blog/2021/cypher-sleuthing-dates-part5/>Cypher Sleuthing: Dealing with Dates, Part 5</a></li><li class=mb2><a href=/blog/2021/cypher-sleuthing-dates-part4/>Cypher Sleuthing: Dealing with Dates, Part 4</a></li><li class=mb2><a href=/blog/2021/cypher-sleuthing-dates-part3/>Cypher Sleuthing: Dealing with Dates, Part 3</a></li><li class=mb2><a href=/blog/2021/cypher-sleuthing-dates-part2/>Cypher Sleuthing: Dealing with Dates, Part 2</a></li><li class=mb2><a href=/blog/2021/cypher-sleuthing-dates-part1/>Cypher Sleuthing: Dealing with Dates, Part 1</a></li><li class=mb2><a href=/blog/2019/cypher-sleuthing-case-statement/>Cypher Sleuthing: the CASE statement</a></li><li class=mb2><a href=/blog/2019/cypher-sleuthing-eager-operator/>Cypher Sleuthing: the EAGER operator</a></li><li class=mb2><a href=/blog/2024/cypher-property-data-types/>Cypher Sleuthing: How to Get Data Types of Properties in Neo4j</a></li><li class=mb2><a href=/blog/2021/java17-graph-explore/>Java 17: Explore the newly-released Java version in a graph database!</a></li></ul></div></aside></article></main><footer class="bg-dark-green bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://jmhreif.com/>&copy; Jennifer Reif 2025</a><div><div class=ananke-socials><a href=https://twitter.com/JMHReif target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/JMHReif target=_blank rel=noopener class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://www.linkedin.com/in/jmhreif/ target=_blank rel=noopener class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://jmhreif.com/index.xml target=_blank rel=noopener class="rss ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="RSS link" aria-label="follow on RSS——Opens in a new window"><span class=icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://jmhreif.podbean.com/ target=_blank rel=noopener class="podcast ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="podcast link" aria-label="follow on podcast——Opens in a new window"><span class=icon><svg width="1200pt" height="1200pt" viewBox="0 0 1200 1200" xmlns="http://www.w3.org/2000/svg"><path d="m6e2 62.484c-296.48.0-537.52 241.03-537.52 537.52s240.98 537.52 537.52 537.52c296.48.0 537.52-240.98 537.52-537.52.0-296.48-241.03-537.52-537.52-537.52zm-155.02 305.02c0-85.5 69.516-155.02 155.02-155.02S755.02 282 755.02 367.504v234.98c0 85.5-69.516 155.02-155.02 155.02s-155.02-69.516-155.02-155.02zm192.52 516.52v66c0 20.484-17.016 37.5-37.5 37.5s-37.5-17.016-37.5-37.5v-66C408 865.508 288 734.024 288 574.504c0-20.484 17.016-37.5 37.5-37.5s37.5 17.016 37.5 37.5c0 130.5 106.5 237 237 237s237-106.5 237-237c0-20.484 17.016-37.5 37.5-37.5s37.5 17.016 37.5 37.5c0 159.52-120 291-274.5 309.52z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>