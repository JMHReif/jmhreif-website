<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Spring AI Upgrade: Changes for Applications from 0.8 to 1.0 | Jennifer Reif</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Photo credit Migrating an application always feels a bit daunting, and that was the way I felt when I looked at the Spring AI 1.0 milestone release.
However, the upgrade didn’t make as many major shifts as anticipated. This guide will help you upgrade your Spring AI application from version 0.8 to 1.0 and explain why each change is needed. Changes include some naming shifts, configuration options, and more."><meta name=generator content="Hugo 0.119.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><link rel=canonical href=https://jmhreif.com/blog/2024/spring-ai-update-10/><meta property="og:title" content="Spring AI Upgrade: Changes for Applications from 0.8 to 1.0"><meta property="og:description" content="Photo credit Migrating an application always feels a bit daunting, and that was the way I felt when I looked at the Spring AI 1.0 milestone release.
However, the upgrade didn’t make as many major shifts as anticipated. This guide will help you upgrade your Spring AI application from version 0.8 to 1.0 and explain why each change is needed. Changes include some naming shifts, configuration options, and more."><meta property="og:type" content="article"><meta property="og:url" content="https://jmhreif.com/blog/2024/spring-ai-update-10/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-07-22T09:00:00-06:00"><meta property="article:modified_time" content="2024-07-22T09:00:00-06:00"><meta itemprop=name content="Spring AI Upgrade: Changes for Applications from 0.8 to 1.0"><meta itemprop=description content="Photo credit Migrating an application always feels a bit daunting, and that was the way I felt when I looked at the Spring AI 1.0 milestone release.
However, the upgrade didn’t make as many major shifts as anticipated. This guide will help you upgrade your Spring AI application from version 0.8 to 1.0 and explain why each change is needed. Changes include some naming shifts, configuration options, and more."><meta itemprop=datePublished content="2024-07-22T09:00:00-06:00"><meta itemprop=dateModified content="2024-07-22T09:00:00-06:00"><meta itemprop=wordCount content="1307"><meta itemprop=keywords content="genai,rag,spring-ai,neo4j,vector,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Spring AI Upgrade: Changes for Applications from 0.8 to 1.0"><meta name=twitter:description content="Photo credit Migrating an application always feels a bit daunting, and that was the way I felt when I looked at the Spring AI 1.0 milestone release.
However, the upgrade didn’t make as many major shifts as anticipated. This guide will help you upgrade your Spring AI application from version 0.8 to 1.0 and explain why each change is needed. Changes include some naming shifts, configuration options, and more."></head><body class="ma0 avenir bg-near-white"><header class="cover bg-top" style=background-image:url(https://jmhreif.com/img/spring-ai/unsplash-step-progress.jpg)><div class=bg-black-60><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Jennifer Reif</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/ title="Home page">Home</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/blog/ title="Blog page">Blog</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/abstracts/ title="Abstracts page">Abstracts</a></li></ul><div class=ananke-socials><a href=https://twitter.com/JMHReif target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/JMHReif target=_blank rel=noopener class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://www.linkedin.com/in/jmhreif/ target=_blank rel=noopener class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://jmhreif.com/index.xml target=_blank rel=noopener class="rss ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="RSS link" aria-label="follow on RSS——Opens in a new window"><span class=icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://jmhreif.podbean.com/ target=_blank rel=noopener class="podcast ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="podcast link" aria-label="follow on podcast——Opens in a new window"><span class=icon><svg width="1200pt" height="1200pt" viewBox="0 0 1200 1200" xmlns="http://www.w3.org/2000/svg"><path d="m6e2 62.484c-296.48.0-537.52 241.03-537.52 537.52s240.98 537.52 537.52 537.52c296.48.0 537.52-240.98 537.52-537.52.0-296.48-241.03-537.52-537.52-537.52zm-155.02 305.02c0-85.5 69.516-155.02 155.02-155.02S755.02 282 755.02 367.504v234.98c0 85.5-69.516 155.02-155.02 155.02s-155.02-69.516-155.02-155.02zm192.52 516.52v66c0 20.484-17.016 37.5-37.5 37.5s-37.5-17.016-37.5-37.5v-66C408 865.508 288 734.024 288 574.504c0-20.484 17.016-37.5 37.5-37.5s37.5 17.016 37.5 37.5c0 130.5 106.5 237 237 237s237-106.5 237-237c0-20.484 17.016-37.5 37.5-37.5s37.5 17.016 37.5 37.5c0 159.52-120 291-274.5 309.52z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav><div class="tc-l pv6 ph3 ph4-ns"></div></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked ttu">Blog</aside><div id=sharing class="mt3 ananke-socials"><a href="https://twitter.com/intent/tweet?url=https://jmhreif.com/blog/2024/spring-ai-update-10/&amp;text=Spring%20AI%20Upgrade:%20Changes%20for%20Applications%20from%200.8%20to%201.0" class="ananke-social-link twitter no-underline" aria-label="share on Twitter"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://jmhreif.com/blog/2024/spring-ai-update-10/&amp;title=Spring%20AI%20Upgrade:%20Changes%20for%20Applications%20from%200.8%20to%201.0" class="ananke-social-link linkedin no-underline" aria-label="share on LinkedIn"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div><h1 class="f1 athelas mt3 mb1">Spring AI Upgrade: Changes for Applications from 0.8 to 1.0</h1><time class="f6 mv4 dib tracked" datetime=2024-07-22T09:00:00-06:00>July 22, 2024</time>
<span class="f6 mv4 dib tracked">- 7 minutes read</span>
<span class="f6 mv4 dib tracked">- 1307 words</span></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><div class=paragraph><small><i><a href="https://unsplash.com/photos/6Lf1kzL4AfY?utm_content=creditShareLink&amp;utm_medium=referral&amp;utm_source=unsplash">Photo credit</a></i></small></div><div class=paragraph><p>Migrating an application always feels a bit daunting, and that was the way I felt when I looked at the Spring AI 1.0 milestone release.</p></div><div class=paragraph><p>However, the upgrade didn’t make as many major shifts as anticipated. This guide will help you upgrade your Spring AI application from version 0.8 to 1.0 and explain why each change is needed. Changes include some naming shifts, configuration options, and more.</p></div><div class=paragraph><p>Let’s get started!</p></div><div class=sect1><h2 id=_dependency_updates>Dependency Updates</h2><div class=sectionbody><div class=paragraph><p>My preferred first step is to upgrade the dependency versions, so that my IDE will highlight many of the changes. It also allows me to start at the bottom of the application (library level) and move up by layer, which is also my go-to development strategy.</p></div><div class=paragraph><p>Since there is also a newer Spring Boot version, I upgraded that to the current <code>3.3.1</code>, then made the focal change to Spring AI’s version property from <code>0.8.1</code> to <code>1.0.0-M1</code> milestone release.</p></div><div class=paragraph><p>After that, I refreshed the Maven dependencies through my IDE to sync versions. The updated <code>pom.xml</code> is available in <a href=https://github.com/JMHReif/springai-goodreads/blob/main/pom.xml#L18 target=_blank rel=noopener>today’s Github repository</a>.</p></div><div class=paragraph><p>Now we can move on to changes in the application code.</p></div></div></div><div class=sect1><h2 id=_key_changes>Key Changes</h2><div class=sectionbody><div class=paragraph><p>In my opinion, the changes needed to the application code made sense, especially if you are already familiar with the typical Spring approach.</p></div><div class=paragraph><p>There is also a newer feature called <a href=https://docs.spring.io/spring-ai/reference/api/chatclient.html#_advisors target=_blank rel=noopener><code>advisors</code></a>, which looks like a nice addition to the Spring AI library. While we don’t have time to cover advisors today, I’ll mention my initial thoughts on it.</p></div><div class=sect2><h3 id=_spring_ai_advisors>Spring AI Advisors</h3><div class=paragraph><p>First, this feature seems most sensible in a chat application, where you may not have a lot of additional logic or calls outside of a question/answer format. Second, it does offer some RAG capabilities, but looks like it only works with a vector search query and not pulling in additional data on top of the similarity search (i.e. related graph data). Third (and finally), advisors feel like a LangChain-esque functionality where a single call can pass on the user question, run a vector search, filter the results, and include those similar results for the LLM to generate its response.</p></div><div class=paragraph><p>In LangChain, the individual call steps are combined and somewhat abstracted away. That could be good if you are familiar with LangChain’s style, but it could also be a bit confusing because it’s not as clear what is happening in the background when the steps are combined into a single command.</p></div><div class=paragraph><p>Ok, back to the changes needed for our application!</p></div></div><div class=sect2><h3 id=_embedding_client_model>Embedding Client → Model</h3><div class=paragraph><p>The first change I had to make was to the <code>EmbeddingClient</code> bean in the main application class. There was a direct replacement for the <code>EmbeddingClient</code> type, which was refactored to an <code>EmbeddingModel</code> type.</p></div><div class=paragraph><p>Everything else looks the same. I just needed to update the term from model to client (plus update the import), and this piece was complete.</p></div><div class=paragraph><p>Here is the updated code snippet:</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-java data-lang=java>@Bean
public EmbeddingModel embeddingModel() {
	return new OpenAiEmbeddingModel(
    new OpenAiApi(
      System.getenv(&#34;SPRING_AI_OPENAI_API_KEY&#34;)));
}</code></pre></div></div><div class=paragraph><p>This next one took me a bit longer to figure out, but it was a simple fix once I put a couple of pieces together.</p></div></div><div class=sect2><h3 id=_vectorstore_config>VectorStore Config</h3><div class=paragraph><p>After updating the <code>EmbeddingModel</code> bean, I also had to update the parameter for the <code>Neo4jVectorStore</code> bean. When I got that verbiage updated, I got another red squiggly line under the the whole <code>Neo4jVectorStore</code> in the return.</p></div><div class=paragraph><p>The error showed <code>Expected 4 arguments but found 3</code>, but what confused me was that it would disappear when I removed the parameter from the <code>.withIndexName()</code> method and ended up being entirely unrelated.</p></div><div class=paragraph><p>My next step was to look at the source code for the <code>Neo4jVectorStore</code> class, but it looked the same. After going through the Neo4j doc page with a fine-toothed comb, I found some text hinting <code>Neo4jVectorStoreConfig</code> now expects a specified <code>initializeSchema</code> parameter (bottom of <a href=https://docs.spring.io/spring-ai/reference/api/vectordbs.html#_schema_initialization target=_blank rel=noopener>this</a> section). This parameter is a boolean and can either be specified in a bean or via a property in the <code>application.properties</code> file.</p></div><div class=paragraph><p>Still, I’d never had to specify that property before, and I couldn’t find content specifying why this changed (<a href=https://spring.io/blog/2024/05/30/spring-ai-1-0-0-m1-released target=_blank rel=noopener>1.0 release blog</a>). The schema initialization stated some vector stores require a schema to be initialized (mentioned <a href=https://docs.spring.io/spring-ai/reference/api/vectordbs.html#_schema_initialization target=_blank rel=noopener>here</a> in the documentation), but the Neo4j Vector Databases page in the documentation show a default of false for the <code>initializeSchema</code> property and didn’t have a dedicated section to call this out.</p></div><div class=paragraph><p>Even after I found this section, since the property default shows <code>false</code> in the docs, it took me awhile to realize that I still needed to specify the parameter whether I used the default or not.</p></div><div class=paragraph><p>Now, to actually explain this parameter…​</p></div><div class=paragraph><p>If you’re familiar with Spring, this parameter will likely make sense. When dealing with Spring Data libraries, you often have the option to have the application use the database schema or push the app’s schema to the database. This parameter is the same concept, but for the vector store.</p></div><div class=paragraph><p>I nearly always default to using whatever the database provides, because I feel that most applications (especially in business environments) set up or have an existing database and don’t use an application-first approach. This would mean specifying the <code>initializeSchema</code> value to <code>false</code>. However, as explained by a colleague, the Neo4j vector store only sets the vector index with this property, so it’s not a full schema initialization. Even better, it only sets the index if it doesn’t exist and uses whatever custom index name you provided for the vector store config.</p></div><div class=paragraph><p>You can see the config code for initializing the schema in the <a href=https://github.com/spring-projects/spring-ai/blob/17c44237a51f85a30d128c21a335a7aee269f4c2/vector-stores/spring-ai-neo4j-store/src/main/java/org/springframework/ai/vectorstore/Neo4jVectorStore.java#L364-L378 target=_blank rel=noopener>Spring AI Github repository under the Neo4j vector store</a>.</p></div><div class=paragraph><p><strong>Note:</strong> This syntax is also Cypher-injection-safe because index names and labels cannot be parameterized, plus the config uses Cypher-DSL to sanitize all the names properly.</p></div><div class=paragraph><p>Finally, here is the updated code snippet for our application’s <code>Neo4jVectorStore</code> bean:</p></div><div class=listingblock><div class=content><pre class=highlight><code class=language-java data-lang=java>@Bean
public Neo4jVectorStore vectorStore(Driver driver, EmbeddingModel embeddingModel) {
	return new Neo4jVectorStore(driver, embeddingModel,
			Neo4jVectorStore.Neo4jVectorStoreConfig.builder()
					.withLabel(&#34;Review&#34;)
					.withIndexName(&#34;review-embedding-index&#34;)
					.build(), true);
}</code></pre></div></div><div class=paragraph><p>Let’s charge ahead to the controller class.</p></div></div><div class=sect2><h3 id=_generic_chat_client_over_chat_model>Generic chat client over chat model</h3><div class=paragraph><p>The biggest change (breaking) was the <code>ChatClient</code> to <code>ChatModel</code>. It is clearly stated with some details in <a href=https://docs.spring.io/spring-ai/reference/upgrade-notes.html#_chatclient_changes target=_blank rel=noopener>the upgrade notes</a>, but I felt this a sensible shift into more Spring-like behavior. It especially makes sense if you are familiar with Spring Data libraries.</p></div><div class=paragraph><p>For those less familiar, let me give a brief summary. Spring tends to deal in layers, where you have lower layer(s) that allow increasing customization of nuts and bolts as you move down, and higher layer(s) that abstract levels of complexity as you move up.</p></div><div class=paragraph><p>I liken this to the <a href=https://docs.spring.io/spring-data/neo4j/reference/introduction-and-preface/building-blocks.html target=_blank rel=noopener>building blocks for Spring Data Neo4j</a> shown below. You have the driver, then client which adds Spring transactions, then template which adds a Spring Boot starter, then repository which adds extra Neo4j-specific features.</p></div><div class=imageblock><div class=content><img src=/img/spring-ai/sdn-building-blocks.png alt="Spring Data Neo4j Building Blocks"></div></div><div class=paragraph><p>In the same way, Spring AI moved the functionality (originally defined in ChatClient) down to the lower-level model layer and abstracted the higher-level client layer. You can use the model instead, if you would prefer, but you can also choose the more abstracted client. The terminology better aligns, and so does the functionality.</p></div><div class=paragraph><p>For our application, this meant tweaking some syntax and altering imports.</p></div><div class=paragraph><p>The other shift I made simultaneously was to use the general <code>ChatClient</code> implementation, rather than a specific <code>OpenAiChatClient</code> (or other model) implementation. This change could allow us to switch to a different LLM in the future without needing to change the controller class.</p></div></div></div></div><div class=sect1><h2 id=_wrapping_up>Wrapping Up!</h2><div class=sectionbody><div class=paragraph><p>After making these changes, I ran the application and it worked as expected. The changes were not as daunting as I initially thought, and I was able to complete the upgrade pretty painlessly.</p></div><div class=paragraph><p>I hope this guide helps you upgrade your Spring AI application from version 0.8 to 1.0, and I hope your experience upgrading is as simple as this. Happy coding!</p></div></div></div><div class=sect1><h2 id=_resources>Resources</h2><div class=sectionbody><div class=ulist><ul><li><p>Code (Github repository): <a href=https://github.com/JMHReif/springai-goodreads target=_blank rel=noopener>Spring AI Goodreads</a></p></li><li><p>Upgrade Notes: <a href=https://docs.spring.io/spring-ai/reference/upgrade-notes.html target=_blank rel=noopener>Spring AI</a></p></li><li><p>Documentation: <a href=https://docs.spring.io/spring-ai/reference/api/vectordbs.html#_schema_initialization target=_blank rel=noopener>Spring AI - Intialize Schema</a></p></li><li><p>Documentation: <a href=https://docs.spring.io/spring-ai/reference/api/vectordbs/neo4j.html#_dependencies target=_blank rel=noopener>Spring AI - Neo4jVectorStore</a></p></li></ul></div></div></div><ul class=pa0><li class="list di"><a href=/tags/genai/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">genai</a></li><li class="list di"><a href=/tags/rag/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">rag</a></li><li class="list di"><a href=/tags/spring-ai/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">spring-ai</a></li><li class="list di"><a href=/tags/neo4j/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">neo4j</a></li><li class="list di"><a href=/tags/vector/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">vector</a></li></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/blog/2024/spring-ai-starter-kit/>GenAI Starter Kit: Everything You Need to Build an Application with Spring AI in Java</a></li><li class=mb2><a href=/blog/2024/spring-ai-app/>Spring AI: How to Write GenAI Applications with Java</a></li><li class=mb2><a href=/blog/2024/rag-demo-retrieval/>Implementing RAG: How to write a graph retrieval query in LangChain</a></li><li class=mb2><a href=/blog/2024/kubernetes-neo4j/>How to Run Neo4j on Kubernetes</a></li><li class=mb2><a href=/blog/2024/cypher-property-data-types/>Cypher Sleuthing: How to Get Data Types of Properties in Neo4j</a></li><li class=mb2><a href=/blog/2021/docker-container-upgrade/>Container Upgrade - Experiences Updating Three Databases</a></li><li class=mb2><a href=/blog/2021/migrate-sdn-part3/>Winter to Spring: Migrating from Spring Data Neo4j 5 to 6, Part 3</a></li><li class=mb2><a href=/blog/2021/java17-graph-explore/>Java 17: Explore the newly-released Java version in a graph database!</a></li><li class=mb2><a href=/blog/2021/migrate-sdn-part2/>Winter to Spring: Migrating from Spring Data Neo4j 5 to 6, Part 2</a></li><li class=mb2><a href=/blog/2021/migrate-sdn-part1/>Winter to Spring: Migrating from Spring Data Neo4j 5 to 6, Part 1</a></li><li class=mb2><a href=/blog/2021/create-data-marvel-sdn/>Create a Data Marvel with Spring Data Neo4j</a></li></ul></div></aside></article></main><footer class="bg-dark-green bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://jmhreif.com/>&copy; Jennifer Reif 2024</a><div><div class=ananke-socials><a href=https://twitter.com/JMHReif target=_blank rel=noopener class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/JMHReif target=_blank rel=noopener class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://www.linkedin.com/in/jmhreif/ target=_blank rel=noopener class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://jmhreif.com/index.xml target=_blank rel=noopener class="rss ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="RSS link" aria-label="follow on RSS——Opens in a new window"><span class=icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path id="scale" d="M4 4.44v2.83c7.03.0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9.0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://jmhreif.podbean.com/ target=_blank rel=noopener class="podcast ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="podcast link" aria-label="follow on podcast——Opens in a new window"><span class=icon><svg width="1200pt" height="1200pt" viewBox="0 0 1200 1200" xmlns="http://www.w3.org/2000/svg"><path d="m6e2 62.484c-296.48.0-537.52 241.03-537.52 537.52s240.98 537.52 537.52 537.52c296.48.0 537.52-240.98 537.52-537.52.0-296.48-241.03-537.52-537.52-537.52zm-155.02 305.02c0-85.5 69.516-155.02 155.02-155.02S755.02 282 755.02 367.504v234.98c0 85.5-69.516 155.02-155.02 155.02s-155.02-69.516-155.02-155.02zm192.52 516.52v66c0 20.484-17.016 37.5-37.5 37.5s-37.5-17.016-37.5-37.5v-66C408 865.508 288 734.024 288 574.504c0-20.484 17.016-37.5 37.5-37.5s37.5 17.016 37.5 37.5c0 130.5 106.5 237 237 237s237-106.5 237-237c0-20.484 17.016-37.5 37.5-37.5s37.5 17.016 37.5 37.5c0 159.52-120 291-274.5 309.52z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>